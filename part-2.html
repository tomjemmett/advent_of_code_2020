<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Part 2 | Day 1</title>
  <meta name="description" content="My attempt to complete AOC 2020 in R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Part 2 | Day 1" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="My attempt to complete AOC 2020 in R" />
  <meta name="github-repo" content="tomjemmett/advent-of-code-2020" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Part 2 | Day 1" />
  
  <meta name="twitter:description" content="My attempt to complete AOC 2020 in R" />
  

<meta name="author" content="Tom Jemmett" />


<meta name="date" content="2020-01-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="part-1.html"/>

<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="part-1.html"><a href="part-1.html"><i class="fa fa-check"></i><b>1</b> Part 1</a>
<ul>
<li class="chapter" data-level="1.1" data-path="part-1.html"><a href="part-1.html#is-the-improved-algorithm-any-better"><i class="fa fa-check"></i><b>1.1</b> is the improved algorithm any better?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="part-2.html"><a href="part-2.html"><i class="fa fa-check"></i><b>2</b> Part 2</a>
<ul>
<li class="chapter" data-level="2.1" data-path="part-2.html"><a href="part-2.html#is-our-improved-algorithm-better-this-time"><i class="fa fa-check"></i><b>2.1</b> Is our improved algorithm better this time?</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Day 1</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="part-2" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Part 2</h1>
<p>We can alter the naive approach from part 1 by adding in an extra for loop.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="part-2.html#cb14-1" aria-hidden="true" tabindex="-1"></a>part_2_naive <span class="ot">&lt;-</span> <span class="cf">function</span>(input, target) {</span>
<span id="cb14-2"><a href="part-2.html#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(input) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">stop</span>(<span class="st">&quot;empty list&quot;</span>)</span>
<span id="cb14-3"><a href="part-2.html#cb14-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-4"><a href="part-2.html#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(input) <span class="sc">-</span> <span class="dv">2</span>)) {</span>
<span id="cb14-5"><a href="part-2.html#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> (i <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(<span class="fu">length</span>(input) <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb14-6"><a href="part-2.html#cb14-6" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (k <span class="cf">in</span> (j <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(input)) {</span>
<span id="cb14-7"><a href="part-2.html#cb14-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (input[[i]] <span class="sc">+</span> input[[j]] <span class="sc">+</span> input[[k]] <span class="sc">==</span> target)</span>
<span id="cb14-8"><a href="part-2.html#cb14-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">return</span> (<span class="fu">prod</span>(input[<span class="fu">c</span>(i, j, k)]))</span>
<span id="cb14-9"><a href="part-2.html#cb14-9" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb14-10"><a href="part-2.html#cb14-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb14-11"><a href="part-2.html#cb14-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-12"><a href="part-2.html#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb14-13"><a href="part-2.html#cb14-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Again, we can test that this method works on the sample.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="part-2.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">part_2_naive</span>(sample, <span class="dv">2020</span>) <span class="sc">==</span> <span class="dv">241861950</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Itâ€™s much harder to adapt the improved algorithm though. My best approach involves a <a href="https://en.wikipedia.org/wiki/Binary_search_algorithm">binary search</a>.</p>
<p>This function takes a sorted array, a target value, a current index into the array, and the current min/max extents to
search. If the value at position i in array is less than target, we look in the left half of the array, chopping it in
half by reducing max. Likewise, if the value is greater than target, we look in the right half of the array, chopping it
in half by increasing min.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="part-2.html#cb17-1" aria-hidden="true" tabindex="-1"></a>binary_search <span class="ot">&lt;-</span> <span class="cf">function</span>(arr, target, i, min, max) {</span>
<span id="cb17-2"><a href="part-2.html#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (arr[[i]] <span class="sc">==</span> target) {</span>
<span id="cb17-3"><a href="part-2.html#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(i)</span>
<span id="cb17-4"><a href="part-2.html#cb17-4" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (target <span class="sc">&lt;</span> arr[[i]]) {</span>
<span id="cb17-5"><a href="part-2.html#cb17-5" aria-hidden="true" tabindex="-1"></a>    max <span class="ot">&lt;-</span> i</span>
<span id="cb17-6"><a href="part-2.html#cb17-6" aria-hidden="true" tabindex="-1"></a>    ni <span class="ot">&lt;-</span> (min <span class="sc">+</span> i) <span class="sc">%/%</span> <span class="dv">2</span></span>
<span id="cb17-7"><a href="part-2.html#cb17-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb17-8"><a href="part-2.html#cb17-8" aria-hidden="true" tabindex="-1"></a>    min <span class="ot">&lt;-</span> i</span>
<span id="cb17-9"><a href="part-2.html#cb17-9" aria-hidden="true" tabindex="-1"></a>    ni <span class="ot">&lt;-</span> (max <span class="sc">+</span> i) <span class="sc">%/%</span> <span class="dv">2</span></span>
<span id="cb17-10"><a href="part-2.html#cb17-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-11"><a href="part-2.html#cb17-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-12"><a href="part-2.html#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (ni <span class="sc">==</span> i) {</span>
<span id="cb17-13"><a href="part-2.html#cb17-13" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NULL</span></span>
<span id="cb17-14"><a href="part-2.html#cb17-14" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb17-15"><a href="part-2.html#cb17-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">binary_search</span>(arr, target, ni, min, max)</span>
<span id="cb17-16"><a href="part-2.html#cb17-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-17"><a href="part-2.html#cb17-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Our improved algorithm for part 2 involves creating two for loops to search from the end of the (sorted) input. We then
remove the third loop by using a binary search to find the target value quicker.</p>
<p>In the two for loops we first calculate the value of the adding these two items together, quickly checking to see if
there is a possible solution (and exiting early if not). Then, we perform a binary search on the rest of the array for
the amount required to make <code>v</code> equal <code>target</code> (2020). If we find the value, then we simply return the results. Else we
continue the search by looping.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="part-2.html#cb18-1" aria-hidden="true" tabindex="-1"></a>part_2_improved <span class="ot">&lt;-</span> <span class="cf">function</span>(input, target) {</span>
<span id="cb18-2"><a href="part-2.html#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(input) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">stop</span>(<span class="st">&quot;empty list&quot;</span>)</span>
<span id="cb18-3"><a href="part-2.html#cb18-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-4"><a href="part-2.html#cb18-4" aria-hidden="true" tabindex="-1"></a>  input <span class="ot">&lt;-</span> <span class="fu">sort</span>(input)</span>
<span id="cb18-5"><a href="part-2.html#cb18-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-6"><a href="part-2.html#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">length</span>(input)<span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb18-7"><a href="part-2.html#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> (j <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">:</span><span class="dv">2</span>) {</span>
<span id="cb18-8"><a href="part-2.html#cb18-8" aria-hidden="true" tabindex="-1"></a>      v <span class="ot">&lt;-</span> <span class="fu">sum</span>(input[<span class="fu">c</span>(i, j)])</span>
<span id="cb18-9"><a href="part-2.html#cb18-9" aria-hidden="true" tabindex="-1"></a>      <span class="co"># early termination</span></span>
<span id="cb18-10"><a href="part-2.html#cb18-10" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (v <span class="sc">&gt;=</span> target) <span class="cf">next</span>()</span>
<span id="cb18-11"><a href="part-2.html#cb18-11" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (v <span class="sc">+</span> input[[i <span class="sc">-</span> <span class="dv">1</span>]] <span class="sc">&lt;</span> target) <span class="cf">next</span>()</span>
<span id="cb18-12"><a href="part-2.html#cb18-12" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb18-13"><a href="part-2.html#cb18-13" aria-hidden="true" tabindex="-1"></a>      <span class="co"># binary search for a suitable value</span></span>
<span id="cb18-14"><a href="part-2.html#cb18-14" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">&lt;-</span> <span class="fu">binary_search</span>(input, target <span class="sc">-</span> v, (i <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">%/%</span> <span class="dv">2</span>, <span class="dv">1</span>, (i <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb18-15"><a href="part-2.html#cb18-15" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(k)) {</span>
<span id="cb18-16"><a href="part-2.html#cb18-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span> (<span class="fu">prod</span>(input[<span class="fu">c</span>(i, j, k)]))</span>
<span id="cb18-17"><a href="part-2.html#cb18-17" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb18-18"><a href="part-2.html#cb18-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-19"><a href="part-2.html#cb18-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb18-20"><a href="part-2.html#cb18-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-21"><a href="part-2.html#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NULL</span></span>
<span id="cb18-22"><a href="part-2.html#cb18-22" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We can once again test that our method works on the sample data:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="part-2.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">part_2_improved</span>(sample, <span class="dv">2020</span>) <span class="sc">==</span> <span class="dv">241861950</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>We can now run both approaches to see what the result is:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="part-2.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">part_2_naive</span>(actual, <span class="dv">2020</span>)</span></code></pre></div>
<pre><code>## [1] 61515678</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="part-2.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">part_2_improved</span>(actual, <span class="dv">2020</span>)</span></code></pre></div>
<pre><code>## [1] 61515678</code></pre>
<div id="is-our-improved-algorithm-better-this-time" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Is our improved algorithm better this time?</h2>
<p>Once again, we can benchmark the two approaches.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="part-2.html#cb25-1" aria-hidden="true" tabindex="-1"></a>bench<span class="sc">::</span><span class="fu">mark</span>(<span class="fu">part_2_naive</span>(actual, <span class="dv">2020</span>),</span>
<span id="cb25-2"><a href="part-2.html#cb25-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">part_2_improved</span>(actual, <span class="dv">2020</span>))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 6
##   expression                         min   median `itr/sec` mem_alloc `gc/sec`
##   &lt;bch:expr&gt;                    &lt;bch:tm&gt; &lt;bch:tm&gt;     &lt;dbl&gt; &lt;bch:byt&gt;    &lt;dbl&gt;
## 1 part_2_naive(actual, 2020)      84.7ms   87.9ms      11.1        0B      0  
## 2 part_2_improved(actual, 2020)   9.35ms   10.2ms      99.6    1.66KB     48.2</code></pre>
<p>On my machine the improved approach is again about 10x quicker, though there are more memory allocations and GC
(garbage collectionâ€™s) happening, so the total execution time is not quite 10x.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="part-1.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
